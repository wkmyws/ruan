<script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/antd/4.9.1/antd.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/antd/4.9.1/antd.min.css">

<div id="root"></div>
<script>
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(arr,i){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(arr)))return;var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}return _arr}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&Symbol.iterator in Object(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}var usrList=[["181090805","123"],["181090806","123"],["181090807","123"],["181090808","123"],["181090809","123"]];var axios_config={headers:{'Content-Type':'multipart/form-data'}};async function getListToken(){var arr=[];usrList.forEach(function(v,i){arr.push(new Promise(function(resolve,reject){var index=i;axios.post('http://47.96.235.211:3000/login',{usr:v[0],pwd:v[1]}).then(function(res){usrList[i][2]=res.data.token;resolve()})}))});var d=new Date();await Promise.all(arr);return(new Date()-d)/usrList.length}async function submit(quick_submit,setProcessBar,bingfa,setSucc,setLoginTime){var loginTime=await getListToken();setLoginTime(loginTime);var startTime=new Date();var uploadList=[];var testList=usrList.slice(0);while(testList.length<bingfa){testList=[].concat(_toConsumableArray(testList),_toConsumableArray(testList))}testList.length=bingfa;setSucc(0);if(_f.files.length)testList.forEach(function(v,i){uploadList.push(new Promise(function(resolve,reject){var token=v[2];var param=new FormData();Array.from(_f.files).forEach(function(v){param.append('file',v)});param.append('work_code',work_code.value);param.append('token',token);param.append('quick_submit',quick_submit);axios.post('http://47.96.235.211:3000/submit_work',param,axios_config).then(function(res){setSucc(function(v){return v+1});return resolve(JSON.stringify(res.data))})}))});var res=await Promise.all(uploadList);var diffTime=new Date()-startTime;return{diffTime:diffTime,avgTime:diffTime/(res.length||1)}}var findIndexReverse=function findIndexReverse(arr,value){for(var i=arr.length-1;i>=0;i--){if(arr[i]==value)return i}return-1};var Step=antd.Steps.Step;var Text=antd.Typography.Text;var App=function App(){var semaphore=0;var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),processBar=_React$useState2[0],setProcessBar=_React$useState2[1];var _React$useState3=React.useState(1),_React$useState4=_slicedToArray(_React$useState3,2),processBarTotal=_React$useState4[0],setProcessBarTotal=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),rqstat=_React$useState6[0],setRqstat=_React$useState6[1];var _React$useState7=React.useState(true),_React$useState8=_slicedToArray(_React$useState7,2),quick_submit=_React$useState8[0],setquick_submit=_React$useState8[1];var _React$useState9=React.useState(0),_React$useState10=_slicedToArray(_React$useState9,2),handleLeft=_React$useState10[0],setHandleLeft=_React$useState10[1];var _React$useState11=React.useState(0),_React$useState12=_slicedToArray(_React$useState11,2),total=_React$useState12[0],setTotal=_React$useState12[1];var _React$useState13=React.useState(0),_React$useState14=_slicedToArray(_React$useState13,2),succ=_React$useState14[0],setSucc=_React$useState14[1];var _React$useState15=React.useState(0),_React$useState16=_slicedToArray(_React$useState15,2),diffTime=_React$useState16[0],setDiffTime=_React$useState16[1];var _React$useState17=React.useState(0),_React$useState18=_slicedToArray(_React$useState17,2),avgTime=_React$useState18[0],setAvgTime=_React$useState18[1];var _React$useState19=React.useState(0),_React$useState20=_slicedToArray(_React$useState19,2),loginTime=_React$useState20[0],setLoginTime=_React$useState20[1];var _React$useState21=React.useState(0),_React$useState22=_slicedToArray(_React$useState21,2),bingfa=_React$useState22[0],setBingfa=_React$useState22[1];var _React$useState23=React.useState([1,0,0,0,0,0]),_React$useState24=_slicedToArray(_React$useState23,2),stepArr=_React$useState24[0],setStepArr=_React$useState24[1];var _React$useState25=React.useState(0),_React$useState26=_slicedToArray(_React$useState25,2),stepNow=_React$useState26[0],setStepNow=_React$useState26[1];var sbt=async function sbt(){setTotal(bingfa);setDiffTime(0);setAvgTime(0);var res=await submit(quick_submit,setProcessBar,bingfa,setSucc,setLoginTime);setDiffTime(res.diffTime);setAvgTime(res.avgTime)};var customDot=function customDot(dot,_ref){var status=_ref.status,index=_ref.index;return React.createElement(antd.Popover,{content:React.createElement("span",null,"\u6B65\u9AA4 ",index+1," \u72B6\u6001: ",status)},dot)};React.useEffect(function(){var rq=setInterval(async function(){if(rqstat==false)return;if(semaphore)return;semaphore=1;var res=await axios.get('http://47.96.235.211:3000/handleDone');setHandleLeft(res.data.left);semaphore=0},rqstat?50:2000);return function(){return clearInterval(rq)}},[rqstat]);return React.createElement("div",null,React.createElement(antd.Row,{type:"flex",justify:"center",align:"middle",style:{minHeight:'100vh'}},React.createElement(antd.Col,{type:"flex",justify:"center",align:"center"},React.createElement(antd.Space,{direction:"vertical",align:"center"},React.createElement(antd.Row,null,React.createElement(antd.Steps,{current:stepNow,progressDot:customDot},React.createElement(Step,{title:"\u5C31\u7EEA",subTitle:"\u5DF2\u51C6\u5907\u597D\u73AF\u5883"}),React.createElement(Step,{title:"\u9009\u62E9\u6587\u4EF6",subTitle:"\u9009\u62E9\u6587\u6863+\u82E5\u5E72\u9644\u4EF6"}),React.createElement(Step,{title:"\u8F93\u5165\u4F5C\u4E1A\u7801",subTitle:"\u65E0\u9700\u6539\u52A8"}),React.createElement(Step,{title:"\u9009\u62E9\u5E76\u53D1\u6570",subTitle:"0-10000"}),React.createElement(Step,{title:"\u542F\u7528\u670D\u52A1\u5668\u76D1\u542C",subTitle:"\u63D0\u4EA4\u6587\u4EF6,\u6D4B\u8BD5\u6027\u80FD"}),React.createElement(Step,{title:"\u67E5\u770B\u7ED3\u679C",subTitle:React.createElement(antd.Button,{type:"primary",shape:"circle",onClick:function onClick(){return setStepNow(0)}},"next")}))),React.createElement(antd.Row,null,React.createElement(antd.Space,null,React.createElement(antd.Timeline,null,React.createElement(antd.Timeline.Item,null,React.createElement("input",{type:"file",style:{border:"1px solid"},id:"_f",multiple:"multiple",onChange:function onChange(){setStepNow(1)}})),React.createElement(antd.Timeline.Item,null,React.createElement(antd.Input,{id:"work_code",value:"Uo9tRt9hNsvXRMKYEYBbbw7bbw7bbw4YB29tRt9hNs9bR6x1kPo8w8dXwUI8i8dTlScjVT6bjPI8wCJOmDJSmEJGnDpatDtD",onClick:function onClick(){setStepNow(2)}})),React.createElement(antd.Timeline.Item,null,React.createElement(Text,{strong:true},"\u5E76\u53D1\u6570\uFF1A"),React.createElement(antd.InputNumber,{min:0,max:10000,value:bingfa,step:100,onChange:function onChange(v){setBingfa(v);setStepNow(3)}})),React.createElement(antd.Timeline.Item,null,React.createElement(antd.Space,{direction:"vertical",align:"center"},React.createElement(antd.Space,null,React.createElement(antd.Col,null,React.createElement(antd.Switch,{size:"large",checkedChildren:"\u76D1\u542C\u670D\u52A1\u5668",unCheckedChildren:"\u6682\u505C\u76D1\u542C",checked:rqstat,onClick:function onClick(){setRqstat(!rqstat);setStepNow(4)}})),React.createElement(antd.Col,null,React.createElement(antd.Switch,{size:"large",checkedChildren:"\u5FEB\u901F\u4E0A\u4F20",unCheckedChildren:"\u666E\u901A\u4E0A\u4F20",checked:quick_submit,onClick:function onClick(){return setquick_submit(function(v){return!v})}}))),React.createElement(antd.Col,{align:"middle"},React.createElement(antd.Button,{type:"primary",onClick:function onClick(){sbt();setStepNow(5)}},"submit")))),React.createElement(antd.Timeline.Item,null,React.createElement(antd.Statistic,{title:"\u63D0\u4EA4\u4F5C\u4E1A\u6570",value:succ,showZero:true,suffix:"/ "+total})),React.createElement(antd.Timeline.Item,null,React.createElement(antd.Row,{align:"center"},React.createElement(antd.Space,null,React.createElement(antd.Statistic,{title:"\u767B\u5F55\u603B\u7528\u65F6",value:loginTime*total,showZero:true,suffix:"ms"}),React.createElement(antd.Statistic,{title:"\u767B\u5F55\u5E73\u5747\u7528\u65F6",value:loginTime,showZero:true,suffix:"ms"})))),React.createElement(antd.Timeline.Item,null,React.createElement(antd.Row,{align:"center"},React.createElement(antd.Space,null,React.createElement(antd.Statistic,{title:"\u4E0A\u4F20\u603B\u7528\u65F6",value:diffTime,showZero:true,suffix:"ms"}),React.createElement(antd.Statistic,{title:"\u4E0A\u4F20\u5E73\u5747\u7528\u65F6",value:avgTime,showZero:true,suffix:"ms"})))),React.createElement(antd.Timeline.Item,null,React.createElement(antd.Statistic,{title:"\u670D\u52A1\u5668\u5F85\u5904\u7406\u4F5C\u4E1A",value:handleLeft,formatter:function formatter(value){return React.createElement(antd.Badge,{count:value,showZero:true,overflowCount:10000})},suffix:"\u4E2A"})))))))))};ReactDOM.render(React.createElement(App,null),document.getElementById('root'));</script>